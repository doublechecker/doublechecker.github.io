!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TrackifyTracker=t():e.TrackifyTracker=t()}(self,(()=>(()=>{"use strict";var e={11:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeStringify=void 0;const r=n(746),i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function o(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}t.unsafeStringify=o,t.default=function(e,t=0){const n=o(e,t);if(!(0,r.default)(n))throw TypeError("Stringified UUID is invalid");return n}},162:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initElementImpressionTracker=function(e=.5,t){if(!document)return;const n=new IntersectionObserver((e=>{e.forEach((e=>{const n=e.target;if(e.isIntersecting)n.dataset.startTime=Date.now().toString(),t("element_impression_start",{$element_id:n.id,$scroll_percent:Math.round((0,r.getScrollDepthPercent)())});else if(n.dataset.startTime){const e=Date.now()-parseInt(n.dataset.startTime);console.log(`Element ${n.id} viewed for ${e}ms`),t("element_impression_end",{$element_id:n.id,$view_time:e,$scroll_percent:Math.round((0,r.getScrollDepthPercent)())}),delete n.dataset.startTime}}))}),{threshold:e});document.querySelectorAll("[ty-track-impression]").forEach((e=>{n.observe(e)}))};const r=n(185)},182:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.validate=t.v7=t.v6ToV1=t.v6=t.v5=t.v4=t.v3=t.v1ToV6=t.v1=t.stringify=t.parse=t.NIL=t.MAX=void 0;var r=n(196);Object.defineProperty(t,"MAX",{enumerable:!0,get:function(){return r.default}});var i=n(465);Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return i.default}});var o=n(797);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return o.default}});var a=n(11);Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return a.default}});var s=n(425);Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return s.default}});var c=n(568);Object.defineProperty(t,"v1ToV6",{enumerable:!0,get:function(){return c.default}});var l=n(591);Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return l.default}});var u=n(286);Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return u.default}});var f=n(557);Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return f.default}});var d=n(356);Object.defineProperty(t,"v6",{enumerable:!0,get:function(){return d.default}});var h=n(268);Object.defineProperty(t,"v6ToV1",{enumerable:!0,get:function(){return h.default}});var g=n(299);Object.defineProperty(t,"v7",{enumerable:!0,get:function(){return g.default}});var m=n(746);Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return m.default}});var p=n(770);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return p.default}})},185:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getScrollDepthPercent=function(){const e=((window.scrollY||document.documentElement.scrollTop)+window.innerHeight)/document.documentElement.scrollHeight*100;return Math.round(100*Math.min(Math.max(e,0),100))/100},t.getGacidFromCookie=function(){let e=document.cookie.split("; ").find((e=>e.startsWith("_ga=")));if(e){e=e.split("=")[1];const t=e.split(".");e=t.length>2?t.slice(-2).join("."):void 0}return e},t.removeNulls=function(e){if(e)for(let t in e)null===e[t]&&delete e[t];return e}},196:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default="ffffffff-ffff-ffff-ffff-ffffffffffff"},268:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(797),i=n(11);t.default=function(e){const t=(n="string"==typeof e?(0,r.default)(e):e,Uint8Array.of((15&n[3])<<4|n[4]>>4&15,(15&n[4])<<4|(240&n[5])>>4,(15&n[5])<<4|15&n[6],n[7],(15&n[1])<<4|(240&n[2])>>4,(15&n[2])<<4|(240&n[3])>>4,16|(240&n[0])>>4,(15&n[0])<<4|(240&n[1])>>4,n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]));var n;return"string"==typeof e?(0,i.unsafeStringify)(t):t}},286:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(779),i=n(291),o=n(11);t.default=function(e,t,n){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();const a=(e=e||{}).random??e.rng?.()??(0,i.default)();if(a.length<16)throw new Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=a[e];return t}return(0,o.unsafeStringify)(a)}},291:(e,t)=>{let n;Object.defineProperty(t,"__esModule",{value:!0});const r=new Uint8Array(16);t.default=function(){if(!n){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(r)}},299:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateV7State=void 0;const r=n(291),i=n(11),o={};function a(e,t,n){return e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],e.msecs=t):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++),e}function s(e,t,n,r,i=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(r){if(i<0||i+16>r.length)throw new RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`)}else r=new Uint8Array(16),i=0;return t??=Date.now(),n??=127*e[6]<<24|e[7]<<16|e[8]<<8|e[9],r[i++]=t/1099511627776&255,r[i++]=t/4294967296&255,r[i++]=t/16777216&255,r[i++]=t/65536&255,r[i++]=t/256&255,r[i++]=255&t,r[i++]=112|n>>>28&15,r[i++]=n>>>20&255,r[i++]=128|n>>>14&63,r[i++]=n>>>6&255,r[i++]=n<<2&255|3&e[10],r[i++]=e[11],r[i++]=e[12],r[i++]=e[13],r[i++]=e[14],r[i++]=e[15],r}t.updateV7State=a,t.default=function(e,t,n){let c;if(e)c=s(e.random??e.rng?.()??(0,r.default)(),e.msecs,e.seq,t,n);else{const e=Date.now(),i=(0,r.default)();a(o,e,i),c=s(i,o.msecs,o.seq,t,n)}return t??(0,i.unsafeStringify)(c)}},330:e=>{e.exports={rE:"0.4.0"}},338:(e,t)=>{function n(e){return 14+(e+64>>>9<<4)+1}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,i,o,a){return r((s=r(r(t,e),r(i,a)))<<(c=o)|s>>>32-c,n);var s,c}function o(e,t,n,r,o,a,s){return i(t&n|~t&r,e,t,o,a,s)}function a(e,t,n,r,o,a,s){return i(t&r|n&~r,e,t,o,a,s)}function s(e,t,n,r,o,a,s){return i(t^n^r,e,t,o,a,s)}function c(e,t,n,r,o,a,s){return i(n^(t|~r),e,t,o,a,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(e){const t=new Uint8Array(4*e.length);for(let n=0;n<4*e.length;n++)t[n]=e[n>>2]>>>n%4*8&255;return t}(function(e,t){const i=new Uint32Array(n(t)).fill(0);i.set(e),i[t>>5]|=128<<t%32,i[i.length-1]=t,e=i;let l=1732584193,u=-271733879,f=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const n=l,i=u,h=f,g=d;l=o(l,u,f,d,e[t],7,-680876936),d=o(d,l,u,f,e[t+1],12,-389564586),f=o(f,d,l,u,e[t+2],17,606105819),u=o(u,f,d,l,e[t+3],22,-1044525330),l=o(l,u,f,d,e[t+4],7,-176418897),d=o(d,l,u,f,e[t+5],12,1200080426),f=o(f,d,l,u,e[t+6],17,-1473231341),u=o(u,f,d,l,e[t+7],22,-45705983),l=o(l,u,f,d,e[t+8],7,1770035416),d=o(d,l,u,f,e[t+9],12,-1958414417),f=o(f,d,l,u,e[t+10],17,-42063),u=o(u,f,d,l,e[t+11],22,-1990404162),l=o(l,u,f,d,e[t+12],7,1804603682),d=o(d,l,u,f,e[t+13],12,-40341101),f=o(f,d,l,u,e[t+14],17,-1502002290),u=o(u,f,d,l,e[t+15],22,1236535329),l=a(l,u,f,d,e[t+1],5,-165796510),d=a(d,l,u,f,e[t+6],9,-1069501632),f=a(f,d,l,u,e[t+11],14,643717713),u=a(u,f,d,l,e[t],20,-373897302),l=a(l,u,f,d,e[t+5],5,-701558691),d=a(d,l,u,f,e[t+10],9,38016083),f=a(f,d,l,u,e[t+15],14,-660478335),u=a(u,f,d,l,e[t+4],20,-405537848),l=a(l,u,f,d,e[t+9],5,568446438),d=a(d,l,u,f,e[t+14],9,-1019803690),f=a(f,d,l,u,e[t+3],14,-187363961),u=a(u,f,d,l,e[t+8],20,1163531501),l=a(l,u,f,d,e[t+13],5,-1444681467),d=a(d,l,u,f,e[t+2],9,-51403784),f=a(f,d,l,u,e[t+7],14,1735328473),u=a(u,f,d,l,e[t+12],20,-1926607734),l=s(l,u,f,d,e[t+5],4,-378558),d=s(d,l,u,f,e[t+8],11,-2022574463),f=s(f,d,l,u,e[t+11],16,1839030562),u=s(u,f,d,l,e[t+14],23,-35309556),l=s(l,u,f,d,e[t+1],4,-1530992060),d=s(d,l,u,f,e[t+4],11,1272893353),f=s(f,d,l,u,e[t+7],16,-155497632),u=s(u,f,d,l,e[t+10],23,-1094730640),l=s(l,u,f,d,e[t+13],4,681279174),d=s(d,l,u,f,e[t],11,-358537222),f=s(f,d,l,u,e[t+3],16,-722521979),u=s(u,f,d,l,e[t+6],23,76029189),l=s(l,u,f,d,e[t+9],4,-640364487),d=s(d,l,u,f,e[t+12],11,-421815835),f=s(f,d,l,u,e[t+15],16,530742520),u=s(u,f,d,l,e[t+2],23,-995338651),l=c(l,u,f,d,e[t],6,-198630844),d=c(d,l,u,f,e[t+7],10,1126891415),f=c(f,d,l,u,e[t+14],15,-1416354905),u=c(u,f,d,l,e[t+5],21,-57434055),l=c(l,u,f,d,e[t+12],6,1700485571),d=c(d,l,u,f,e[t+3],10,-1894986606),f=c(f,d,l,u,e[t+10],15,-1051523),u=c(u,f,d,l,e[t+1],21,-2054922799),l=c(l,u,f,d,e[t+8],6,1873313359),d=c(d,l,u,f,e[t+15],10,-30611744),f=c(f,d,l,u,e[t+6],15,-1560198380),u=c(u,f,d,l,e[t+13],21,1309151649),l=c(l,u,f,d,e[t+4],6,-145523070),d=c(d,l,u,f,e[t+11],10,-1120210379),f=c(f,d,l,u,e[t+2],15,718787259),u=c(u,f,d,l,e[t+9],21,-343485551),l=r(l,n),u=r(u,i),f=r(f,h),d=r(d,g)}return Uint32Array.of(l,u,f,d)}(function(e){if(0===e.length)return new Uint32Array;const t=new Uint32Array(n(8*e.length)).fill(0);for(let n=0;n<e.length;n++)t[n>>2]|=(255&e[n])<<n%4*8;return t}(e),8*e.length))}},356:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(11),i=n(425),o=n(568);t.default=function(e,t,n){e??={},n??=0;let a=(0,i.default)({...e,_v6:!0},new Uint8Array(16));if(a=(0,o.default)(a),t){for(let e=0;e<16;e++)t[n+e]=a[e];return t}return(0,r.unsafeStringify)(a)}},425:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateV1State=void 0;const r=n(291),i=n(11),o={};function a(e,t,n){return e.msecs??=-1/0,e.nsecs??=0,t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=n.slice(10,16),e.node[0]|=1,e.clockseq=16383&(n[8]<<8|n[9])),e.msecs=t,e}function s(e,t,n,r,i,o,a=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(o){if(a<0||a+16>o.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`)}else o=new Uint8Array(16),a=0;t??=Date.now(),n??=0,r??=16383&(e[8]<<8|e[9]),i??=e.slice(10,16);const s=(1e4*(268435455&(t+=122192928e5))+n)%4294967296;o[a++]=s>>>24&255,o[a++]=s>>>16&255,o[a++]=s>>>8&255,o[a++]=255&s;const c=t/4294967296*1e4&268435455;o[a++]=c>>>8&255,o[a++]=255&c,o[a++]=c>>>24&15|16,o[a++]=c>>>16&255,o[a++]=r>>>8|128,o[a++]=255&r;for(let e=0;e<6;++e)o[a++]=i[e];return o}t.updateV1State=a,t.default=function(e,t,n){let c;const l=e?._v6??!1;if(e){const t=Object.keys(e);1===t.length&&"_v6"===t[0]&&(e=void 0)}if(e)c=s(e.random??e.rng?.()??(0,r.default)(),e.msecs,e.nsecs,e.clockseq,e.node,t,n);else{const e=Date.now(),i=(0,r.default)();a(o,e,i),c=s(i,o.msecs,o.nsecs,l?void 0:o.clockseq,l?void 0:o.node,t,n)}return t??(0,i.unsafeStringify)(c)}},465:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default="00000000-0000-0000-0000-000000000000"},557:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;const r=n(829),i=n(988);var o=n(988);function a(e,t,n,o){return(0,i.default)(80,r.default,e,t,n,o)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return o.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return o.URL}}),a.DNS=i.DNS,a.URL=i.URL,t.default=a},568:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(797),i=n(11);t.default=function(e){const t=(n="string"==typeof e?(0,r.default)(e):e,Uint8Array.of((15&n[6])<<4|n[7]>>4&15,(15&n[7])<<4|(240&n[4])>>4,(15&n[4])<<4|(240&n[5])>>4,(15&n[5])<<4|(240&n[0])>>4,(15&n[0])<<4|(240&n[1])>>4,(15&n[1])<<4|(240&n[2])>>4,96|15&n[2],n[3],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]));var n;return"string"==typeof e?(0,i.unsafeStringify)(t):t}},591:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;const r=n(338),i=n(988);var o=n(988);function a(e,t,n,o){return(0,i.default)(48,r.default,e,t,n,o)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return o.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return o.URL}}),a.DNS=i.DNS,a.URL=i.URL,t.default=a},697:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i},746:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(697);t.default=function(e){return"string"==typeof e&&r.default.test(e)}},770:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(746);t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},779:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const n="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);t.default={randomUUID:n}},797:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(746);t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");let t;return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,255&t,(t=parseInt(e.slice(9,13),16))>>>8,255&t,(t=parseInt(e.slice(14,18),16))>>>8,255&t,(t=parseInt(e.slice(19,23),16))>>>8,255&t,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,255&t)}},829:(e,t)=>{function n(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function r(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520],o=new Uint8Array(e.length+1);o.set(e),o[e.length]=128;const a=(e=o).length/4+2,s=Math.ceil(a/16),c=new Array(s);for(let t=0;t<s;++t){const n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];c[t]=n}c[s-1][14]=8*(e.length-1)/Math.pow(2,32),c[s-1][14]=Math.floor(c[s-1][14]),c[s-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<s;++e){const o=new Uint32Array(80);for(let t=0;t<16;++t)o[t]=c[e][t];for(let e=16;e<80;++e)o[e]=r(o[e-3]^o[e-8]^o[e-14]^o[e-16],1);let a=i[0],s=i[1],l=i[2],u=i[3],f=i[4];for(let e=0;e<80;++e){const i=Math.floor(e/20),c=r(a,5)+n(i,s,l,u)+f+t[i]+o[e]>>>0;f=u,u=l,l=r(s,30)>>>0,s=a,a=c}i[0]=i[0]+a>>>0,i[1]=i[1]+s>>>0,i[2]=i[2]+l>>>0,i[3]=i[3]+u>>>0,i[4]=i[4]+f>>>0}return Uint8Array.of(i[0]>>24,i[0]>>16,i[0]>>8,i[0],i[1]>>24,i[1]>>16,i[1]>>8,i[1],i[2]>>24,i[2]>>16,i[2]>>8,i[2],i[3]>>24,i[3]>>16,i[3]>>8,i[3],i[4]>>24,i[4]>>16,i[4]>>8,i[4])}},942:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initScrollTracker=function(e=1e3,t){let n;window.addEventListener("scroll",(()=>{n&&clearTimeout(n),n=window.setTimeout((()=>{const e=(0,r.getScrollDepthPercent)();t("scroll",{$scroll_percent:e})}),e)}))};const r=n(185)},988:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=t.stringToBytes=void 0;const r=n(797),i=n(11);function o(e){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t}t.stringToBytes=o,t.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",t.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",t.default=function(e,t,n,a,s,c){const l="string"==typeof n?o(n):n,u="string"==typeof a?(0,r.default)(a):a;if("string"==typeof a&&(a=(0,r.default)(a)),16!==a?.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let f=new Uint8Array(16+l.length);if(f.set(u),f.set(l,u.length),f=t(f),f[6]=15&f[6]|e,f[8]=63&f[8]|128,s){c=c||0;for(let e=0;e<16;++e)s[c+e]=f[e];return s}return(0,i.unsafeStringify)(f)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.TrackifyTracker=void 0,e.getTyTracker=function(){return window.tyTracker},e.initTyTracker=s,e.tyTrackEvent=function(e,t,n=!1){window.tyTracker&&window.tyTracker.trackEvent(e,t,n)},e.tyAssociateUser=function(e,t=!1){window.tyTracker&&window.tyTracker.associateUser(e,t)},e.tySetClientProperties=function(e,t=!1){window.tyTracker&&window.tyTracker.setClientProperties(e,t)};const t=n(182),i=n(162),o=n(942),a=n(185);function s(e){return window.tyTracker||(window.tyTracker=new c(e)),window.tyTracker}"undefined"!=typeof window&&(window.initTyTracker=s);class c{constructor(e){this.batch=[],this.lastSend=new Date,this.sendInterval=5e3,this.pageViewId=(0,t.v4)(),e.debug=e.debug||!1,e.autoTrackClicks=e.autoTrackClicks||!0,e.autoTrackPageView=e.autoTrackPageView||!0,e.autoTrackElementImpressions=e.autoTrackElementImpressions||!0,e.autoTrackScrolls=e.autoTrackScrolls||!0,e.environment=e.environment||"production",e.storeClientId=e.storeClientId||(e=>{"localhost"===window.location.hostname||""===window.location.hostname?localStorage.setItem("tycid",e):document.cookie=`tycid=${e}; path=/; domain=${window.location.hostname}; max-age=31536000; SameSite=Lax`}),e.getClientId=e.getClientId||(()=>{var e;return"localhost"===window.location.hostname||""===window.location.hostname?localStorage.getItem("tycid"):(null===(e=document.cookie.split("; ").find((e=>e.startsWith("tycid="))))||void 0===e?void 0:e.split("=")[1])||null}),this.config=e,this.init(),setInterval((()=>{this.checkForEventsToSend()}),this.sendInterval)}getClientId(){return this.config.getClientId()}getOrCreateClientId(){let e=this.getClientId();return e||(e=(0,t.v4)(),this.storeClientId(e)),e}storeClientId(e){this.config.storeClientId(e)}getDeviceId(){let e=localStorage.getItem("ty_did");return e||(e=(0,t.v4)(),localStorage.setItem("ty_did",e)),e}initBeforeUnloadListener(){document.addEventListener("beforeunload",(()=>{this.track([this.createTrackEvent("page_leave")],!0)}))}initClickListener(){document.addEventListener("click",(e=>{let t=e.target;for(;t&&!t.matches("button, a");)t=t.parentElement;const n=[];if(t&&(this.log("Clicked:",t.tagName,t.innerText.trim()||t.getAttribute("href")),this.config.autoTrackClicks&&n.push(this.createTrackEvent("click",{$clicked_element:t.tagName,$clicked_text:t.innerText.trim(),$clicked_href:t.getAttribute("href")}))),t&&"a"===t.tagName.toLowerCase()&&t.href){if(new URL(t.href).hostname===window.location.hostname)return;e.preventDefault();let r=new URL(t.href),i=this.getClientId();r.searchParams.set("cid",i),this.log("Navigating to:",r.toString()),n.push(this.createTrackEvent("page_leave")),this.track(n,!0),window.location.href=r.toString()}else this.track(n,!0)}))}log(e,...t){this.config.debug&&console.log(e,...t)}init(){const e=[];let t=new URL(window.location.href),n=t.searchParams.get("gclid"),r=t.searchParams.get("utm_campaign"),i=t.searchParams.get("utm_source"),o=t.searchParams.get("utm_medium"),s=t.searchParams.get("utm_term"),c=t.searchParams.get("utm_content"),l=(0,a.getGacidFromCookie)(),u=t.searchParams.get("cid"),f=!1;if(u){const t=this.getClientId();t?t!==u&&(e.push(this.createAssociateEvent({clientId:u})),this.storeClientId(u)):(this.storeClientId(u),e.push(this.createTrackEvent("first_visit",{$referrer:document.referrer,$referred_cid:u,$gclid:n,$utm_campaign:r,$utm_source:i,$utm_medium:o,$utm_term:s,$utm_content:c,$gacid:l})),f=!0)}else this.getClientId()||(this.getOrCreateClientId(),e.push(this.createTrackEvent("first_visit",{$referrer:document.referrer,$referred_cid:u,$gclid:n,$utm_campaign:r,$utm_source:i,$utm_medium:o,$utm_term:s,$utm_content:c,$gacid:l})),e.push(this.createSetClientPropertiesEvent({$initial_gclid:n,$initial_utm_campaign:r,$initial_utm_source:i,$initial_utm_medium:o,$initial_utm_term:s,$initial_utm_content:c,$initial_gacid:l})),f=!0);this.config.autoTrackPageView&&e.push(this.createTrackEvent("page_view",{$referrer:document.referrer,$referred_cid:u,$tracker_init:!0,$is_first_visit:f,$gclid:n,$utm_campaign:r,$utm_source:i,$utm_medium:o,$utm_term:s,$utm_content:c,$gacid:l})),n&&e.push(this.createAssociateEvent({gclid:n})),l&&e.push(this.createAssociateEvent({gacid:l})),this.track(e,!0),(null==this.config.autoTrackClicks||this.config.autoTrackClicks)&&this.initClickListener(),this.initBeforeUnloadListener(),document.addEventListener("DOMContentLoaded",(()=>{this.initScrollTracker(),this.initImpressionTracker()}))}initScrollTracker(){this.config.autoTrackScrolls&&(0,o.initScrollTracker)(1e3,((e,t,n)=>{this.trackEvent(e,t,n)}))}initImpressionTracker(){this.config.autoTrackElementImpressions&&(0,i.initElementImpressionTracker)(.5,((e,t,n)=>{this.trackEvent(e,t,n)}))}associateUser(e,t){e?this.track([this.createAssociateEvent({userId:e})],t):this.log("User ID is null or undefined. Not associating user.")}associateClient(e,t){e?this.track([this.createAssociateEvent({clientId:e})],t):this.log("Client ID is null or undefined. Not associating user.")}setClientProperties(e,t){this.track([this.createSetClientPropertiesEvent(e)],t)}createSetClientPropertiesEvent(e){const t=(0,a.removeNulls)(e);return(0,a.removeNulls)({type:"client_properties",sid:this.config.streamId,cid:this.getOrCreateClientId(),timestamp:Math.floor(Date.now()/1e3),clientProperties:t})}createAssociateEvent(e){return(0,a.removeNulls)({type:"associate",sid:this.config.streamId,cid:this.getOrCreateClientId(),timestamp:Math.floor(Date.now()/1e3),userId:e.userId,clientId:e.clientId,gacid:e.gacid,gclid:e.gclid})}createTrackEvent(e,t){if(t)for(let e in t)null===t[e]&&delete t[e];const r=window.location.href.split("?")[0];return{type:"event",sid:this.config.streamId,cid:this.getOrCreateClientId(),timestamp:Math.floor(Date.now()/1e3),en:e,attributes:Object.assign(Object.assign({},(0,a.removeNulls)(t)),{$current_location:r,$current_path:window.location.pathname,$host:window.location.hostname,$tracker_lib:"js",$tracker_version:n(330).rE,$tracker_env:this.config.environment,$device_id:this.getDeviceId(),$page_view_id:this.pageViewId})}}trackEvent(e,t,n=!1){this.track([this.createTrackEvent(e,t)],n)}track(e,t=!1){if(this.batch.push(...e),this.lastSend.getTime()+this.sendInterval<(new Date).getTime()||t){this.lastSend=new Date;const e=[...this.batch];this.batch=[],this.lastSend=new Date,this.sendEvents(e)}}checkForEventsToSend(){if(this.batch.length>0&&this.lastSend.getTime()+this.sendInterval<(new Date).getTime()){this.lastSend=new Date;const e=[...this.batch];this.batch=[],this.lastSend=new Date,this.sendEvents(e)}}sendEvents(e){if("https:"===window.location.protocol)navigator.sendBeacon(this.config.url+"/tracker/v1",JSON.stringify(e));else{const t=new XMLHttpRequest;t.open("POST",this.config.url+"/tracker/v1",!0),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify(e))}}}e.TrackifyTracker=c})(),r})()));